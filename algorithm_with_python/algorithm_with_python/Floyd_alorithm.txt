min_distance algorithm for all elements
